# 横向选择界面设计

设计日期：2025-11-05
设计目标：采用横向滑动方式选择套餐，更好地利用127像素宽度

---

## 🎨 界面设计

### 布局示意图

```
┌─────────────────────────────────────┐
│           SELECT                    │  Y=17 (Bold 10pt)
│                                     │
│                                     │
│     <       $4        >             │  Y=34 (Bold 10pt + 箭头)
│          4 Minutes                  │  Y=46 (Regular 8pt)
│                                     │
│        ■ □ □ □ □                   │  Y=54 (位置指示点)
└─────────────────────────────────────┘
```

### 视觉层次

```
层1: 标题 "SELECT"              (顶部居中)
层2: 左箭头 "<"                 (左侧，仅非第一项时显示)
层3: 当前套餐价格/名称 "$4"      (中央，大字体)
层4: 右箭头 ">"                 (右侧，仅非最后项时显示)
层5: 套餐详情 "4 Minutes"        (中下方，中字体)
层6: 位置指示点 ■□□□□           (底部居中)
```

---

## 📐 精确布局参数

### 可视区域
- 宽度: 127像素
- 高度: 53像素
- 起始点: (0, 6)

### 各元素位置

#### 1. 标题 "SELECT"
```cpp
字体: u8g2_font_helvB10_tf (Bold 10pt)
位置: Y = area.y + 11 = 17
对齐: 水平居中
```

#### 2. 主内容区域（套餐信息）
```cpp
中心点: centerY = area.y + area.height / 2 + 2 = 34

// 价格/名称
字体: u8g2_font_helvB10_tf (Bold 10pt)
位置: Y = centerY = 34
对齐: 水平居中

// 详情（时长）
字体: u8g2_font_helvR08_tf (Regular 8pt)
位置: Y = centerY + 12 = 46
对齐: 水平居中
```

#### 3. 左右箭头
```cpp
字体: u8g2_font_helvB10_tf (Bold 10pt)
左箭头: X = area.x + 2 = 2,  Y = centerY + 3 = 37
右箭头: X = area.x + area.width - 10 = 117,  Y = centerY + 3 = 37

显示条件:
- 左箭头: selectedPackage > 0
- 右箭头: selectedPackage < PACKAGE_COUNT - 1
```

#### 4. 位置指示点
```cpp
位置: Y = area.y + area.height - 5 = 54
间距: 6像素/点
尺寸: 4×4像素

计算:
totalWidth = PACKAGE_COUNT × 6 = 30像素
startX = area.x + (area.width - totalWidth) / 2 = 48

点的位置:
点0: X = 50
点1: X = 56
点2: X = 62
点3: X = 68
点4: X = 74

显示:
- 当前选中: display.drawBox() (实心)
- 未选中: display.drawFrame() (空心)
```

---

## 📊 5个套餐的显示内容

### 套餐1: $4 - 4分钟
```
     SELECT

  <    $4    >
    4 Minutes

    ■ □ □ □ □
```

### 套餐2: $5 - 5分钟
```
     SELECT

  <    $5    >
    5 Minutes

    □ ■ □ □ □
```

### 套餐3: $8 - 8分钟
```
     SELECT

  <    $8    >
    8 Minutes

    □ □ ■ □ □
```

### 套餐4: $15 - 15分钟
```
     SELECT

  <   $15    >
   15 Minutes

    □ □ □ ■ □
```

### 套餐5: VIP Info查询
```
     SELECT

  < VIP INFO  >
 Check Balance

    □ □ □ □ ■
```

---

## 🎯 交互逻辑

### 按键操作

#### SELECT按钮（上下切换）
```cpp
// 按下SELECT按钮 → 下一个套餐
selectedPackage++;
if (selectedPackage >= PACKAGE_COUNT) {
  selectedPackage = 0;  // 循环到第一个
}
displayPackageSelection();
```

**视觉效果**：
- 中央显示的套餐信息切换
- 左右箭头根据位置显示/隐藏
- 底部指示点移动

#### OK按钮（确认选择）
```cpp
// 按下OK按钮 → 确认当前套餐
if (packages[selectedPackage].isQuery) {
  // 进入VIP查询界面
  currentState = STATE_VIP_QUERY;
} else {
  // 进入刷卡支付界面
  currentState = STATE_CARD_SCAN;
}
```

---

## 💡 优势分析

### 与纵向列表对比

| 特性 | 纵向列表 | 横向滑动 |
|-----|---------|---------|
| 空间利用 | 需要53px高度显示5行 | 只需34px高度 |
| 字体大小 | 8pt紧凑字体 | 10pt舒适字体 |
| 可读性 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 现代感 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 视觉焦点 | 分散（5行） | 集中（1行） |
| 操作反馈 | 箭头指示 | 箭头+指示点 |

### 主要优势

1. **更大字体** - 10pt vs 8pt，提升50%可读性
2. **视觉焦点** - 一次只显示一个套餐，用户注意力集中
3. **现代UI** - 类似手机App的横向滑动界面
4. **充足空间** - 节省19像素垂直空间（53-34=19）
5. **清晰指示** - 双重指示器（箭头+指示点）

---

## 🔧 技术实现

### 核心代码逻辑

```cpp
void displayPackageSelection() {
  // 1. 获取当前选中的套餐
  const Package& pkg = packages[selectedPackage];

  // 2. 显示套餐主要信息（价格或名称）
  if (pkg.isQuery) {
    display "VIP INFO"
  } else {
    display "$价格"
  }

  // 3. 显示套餐详情
  if (pkg.isQuery) {
    display "Check Balance"
  } else {
    display "X Minutes"
  }

  // 4. 显示左箭头（如果不是第一个）
  if (selectedPackage > 0) {
    display "<"
  }

  // 5. 显示右箭头（如果不是最后一个）
  if (selectedPackage < PACKAGE_COUNT - 1) {
    display ">"
  }

  // 6. 绘制位置指示点
  for (每个套餐) {
    if (是当前选中) {
      drawBox (实心)
    } else {
      drawFrame (空心)
    }
  }
}
```

---

## 📱 用户体验流程

### 场景1：选择$8套餐

```
步骤1: 默认显示$4
┌─────────────────┐
│    SELECT       │
│                 │
│  <   $4    >    │
│   4 Minutes     │
│  ■ □ □ □ □     │
└─────────────────┘

用户操作: 按SELECT按钮2次

步骤2: 显示$5
┌─────────────────┐
│    SELECT       │
│                 │
│  <   $5    >    │
│   5 Minutes     │
│  □ ■ □ □ □     │
└─────────────────┘

步骤3: 显示$8 (目标)
┌─────────────────┐
│    SELECT       │
│                 │
│  <   $8    >    │
│   8 Minutes     │
│  □ □ ■ □ □     │
└─────────────────┘

用户操作: 按OK按钮确认

结果: 进入刷卡界面，选中$8套餐
```

### 场景2：VIP查询

```
步骤1: 默认显示$4
┌─────────────────┐
│    SELECT       │
│                 │
│  <   $4    >    │
│   4 Minutes     │
│  ■ □ □ □ □     │
└─────────────────┘

用户操作: 按SELECT按钮4次

步骤2: 显示VIP INFO
┌─────────────────┐
│    SELECT       │
│                 │
│  < VIP INFO     │
│ Check Balance   │
│  □ □ □ □ ■     │
└─────────────────┘

用户操作: 按OK按钮确认

结果: 进入VIP查询界面
```

---

## 🎨 样式细节

### 字体选择
- **标题**: Bold 10pt - 清晰有力
- **价格**: Bold 10pt - 突出重点
- **详情**: Regular 8pt - 辅助信息
- **箭头**: Bold 10pt - 操作指示

### 颜色方案（黑白屏）
- 主要文字：黑色（反色显示）
- 当前指示点：黑色实心（■）
- 其他指示点：黑色空心（□）
- 背景：白色

### 间距规范
- 标题到主内容：23像素（34-11=23）
- 主内容到详情：12像素
- 详情到指示点：8像素（54-46=8）
- 指示点之间：6像素

---

## 🔄 未来扩展

### 如果套餐数量增加到6-7个
- 指示点宽度：6×7=42像素（仍然适合127像素宽度）
- 可以考虑使用更小的指示点（3×3像素）

### 可选增强功能
1. **动画效果**：切换时添加滑动动画
2. **渐变显示**：左右两侧显示相邻套餐（半透明）
3. **数字序号**：显示"2/5"替代指示点

---

## 📚 相关文件

1. **[GoldSky_Display.ino](../GoldSky_Display.ino)** - Lines 83-144
   - `displayPackageSelection()` 函数实现

2. **[config.h](../config.h)** - Lines 158-167
   - 套餐配置定义

3. **[GoldSky_Lite.ino](../GoldSky_Lite.ino)** - 主循环
   - SELECT按钮处理逻辑
   - OK按钮处理逻辑

---

## 🎯 总结

### 设计原则
1. **简洁至上** - 一次只显示一个套餐
2. **清晰导航** - 双重指示器（箭头+点）
3. **充分利用** - 横向空间利用最大化
4. **现代体验** - 类似移动端的滑动选择

### 实现成果
✅ 5个套餐+VIP查询全部支持
✅ 字体提升到10pt（原8pt）
✅ 节省19像素垂直空间
✅ 视觉焦点集中，操作更直观

---

**文档版本**: v1.0
**最后更新**: 2025-11-05
**状态**: ✅ 已实现横向选择界面
